import { Meta, Story, Canvas, ArgsTable  } from '@storybook/addon-docs/blocks';
import { moduleMetadata, componentWrapperDecorator } from '@storybook/angular';
import { CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import { ListComponent } from './list.component.ts'

export const Template = (args) => <ListComponent { ...args }/>;

<Meta
    title="Components/List"
    decorators={[
        moduleMetadata({
        schemas: [ CUSTOM_ELEMENTS_SCHEMA ]
        })
    ]}
    component={ ListComponent }
    parameters={{ viewMode: 'docs' }}
    argTypes={{
        loading: { control: 'boolean' }
    }}
/>

# List Component

Paginated list component.

It is a wrapper of [**glyph-list**](https://adrianiy.github.io/glyph-ui/?path=/docs/webcomponents_components-list--basic). Handles data transformation between apps and list component.

## Basic list

<Canvas>
    <Story name="Basic" args={{ loading: false, data, activeKpi: 'amount', fieldsConfig, title: 'List', limit: 3, enableDownload: true}}>
        { Template.bind({})}
    </Story>
</Canvas>

## List with children

<Canvas>
    <Story name="With children" args={{ loading: false, data: childrenData, activeKpi: 'amount', fieldsConfig, title: 'List', limit: 3, enableDownload: true, expandable: true}}>
        { Template.bind({})}
    </Story>
</Canvas>

## List with actions

<Canvas>
    <Story
        name="With actions"
        decorators={[componentWrapperDecorator((story) => `<div style="width: 300px">${story}</div>`)]}
        args={{ data: actionData, limit: 3, loading: false, activeKpi: 'amount' , fieldsConfig, title: 'List with actions', enableDownload: true }}>
        {Template.bind({})}
    </Story>
</Canvas>

## Loading list

<Canvas>
    <Story name="Loading" args={{ loading: true, limit: 3, title: 'List' }}>{ Template.bind({}) }</Story>
</Canvas>

## No data list

<Canvas>
    <Story name="No data" args={{ loading: false, limit: 3, title: 'List' }}>{ Template.bind({}) }</Story>
</Canvas>

---

## Properties

<ArgsTable of={ListComponent} />

export const data = [
    {
        _isTotal: true,
        name: 'total',
        amount: 999999,
        growth_amount: 0.23,
    },
].concat(
    [ 'España', 'Estados unidos', 'Canada', 'Francia', 'Irlanda', 'Croacia', 'Corea', 'Taiwan' ].map((country) => ({
        name: country,
        amount: Math.random() * 10000,
        growth_amount: Math.random(),
    }
)));
export const childrenData = [
    {
        _isTotal: true,
        name: 'total',
        amount: 999999,
        growth_amount: 0.23,
    },
].concat([ 'España', 'Estados unidos', 'Canada', 'Francia', 'Irlanda', 'Croacia', 'Corea', 'Taiwan' ].map((name, i) => (
    {
        _isTotal: false,
        name,
        amount: 12311,
        growth_amount: 0.98,
        children: [
            {
                name: 'child',
                amount: 999999,
                growth_amount: 0.23,
            }
        ]
    }
)));
export const actionData = [
    {
        _isTotal: true,
        name: 'total',
        amount: 999999,
        growth_amount: 0.23,
    },
].concat([ 'España', 'Estados unidos', 'Canada', 'Francia', 'Irlanda', 'Croacia', 'Corea', 'Taiwan' ].map((name, i) => (
    {
        _isTotal: false,
        _actions: i % 2
            ? [ { icon: 'bar_chart', title: 'Analize', action: () => alert('action') } ]
            : [{ icon: 'bar_chart', title: 'Analize', action: () => alert('analyze') },{ icon: 'lightbulb', title: 'Insights', action: () => alert('insight') }],
        name,
        amount: 12311,
        growth_amount: 0.98,
    }
)));

export const fieldsConfig = [
    {
        title: () => 'amount',
        value: () => 'amount',
        format: () => '0,0',
        decoration: () => 'green',
        sign: () => false,
    },
    {
        title: () => 'crec.',
        value: () => 'growth_amount',
        format: () => '0,0.0 %',
        decoration: () => 'green',
        sign: () => false,
    },
];
